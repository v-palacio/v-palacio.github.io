{% include base_path %}

<!-- start custom head snippets -->
<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&family=Figtree:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

<style>
/* Custom font weight adjustments */
body {
  font-weight: 400;
}

h1, h2, h3, h4, h5, h6 {
  font-weight: 500;
}

/* Ensure proper font loading */
@font-face {
  font-family: 'Figtree';
  font-display: swap;
}

@font-face {
  font-family: 'Bitter';
  font-display: swap;
}
</style>
<!-- Support for Academicons -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/academicons.css"/>

<!-- favicon from https://commons.wikimedia.org/wiki/File:OOjs_UI_icon_academic-progressive.svg -->
<link rel="apple-touch-icon" sizes="180x180" href="{{ base_path }}/images/apple-touch-icon-180x180.png"/>
<link rel="icon" type="image/svg+xml" href="{{ base_path }}/images/favicon.svg"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-192x192.png" sizes="192x192"/>
<link rel="manifest" href="{{ base_path }}/images/manifest.json"/>
<link rel="icon" href="/images/favicon.ico"/>
<meta name="theme-color" content="#ffffff"/>

<!-- Auto-open external links in new tabs -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Find all external links (excluding GitHub Pages and localhost)
    const externalLinks = document.querySelectorAll('a[href^="http://"]:not([href*="localhost"]):not([href*="127.0.0.1"]):not([href*="github.io"]), a[href^="https://"]:not([href*="localhost"]):not([href*="127.0.0.1"]):not([href*="github.io"])');
    
    // Add target="_blank" and rel="noopener noreferrer" to external links
    externalLinks.forEach(function(link) {
        link.setAttribute('target', '_blank');
        link.setAttribute('rel', 'noopener noreferrer');
    });

    // No scroll indicators - clean horizontal scroll navigation

});

// Remove Google Analytics and other tracking parameters from URLs
<!-- Clean tracking/query params from URL on load and navigation -->
<script>
(function () {
  const TRACKING_KEYS = new Set([
    '_gl','_ga','_gid','_gclid','_gclsrc','gclid','fbclid','msclkid','twclid',
  ]);

  function isTrackingParam(key) {
    return TRACKING_KEYS.has(key) || key.toLowerCase().startsWith('utm_');
  }

  function cleanURL() {
    try {
      const url = new URL(window.location.href);
      let changed = false;

      // Remove known tracking parameters only
      for (const [key] of url.searchParams) {
        if (isTrackingParam(key)) {
          url.searchParams.delete(key);
          changed = true;
        }
      }

      if (changed) {
        // Preserve origin, path, and hash; drop the (now empty) search string
        const clean = url.origin + url.pathname + (url.hash || '');
        window.history.replaceState({}, document.title, clean);
      }
    } catch (e) {
      // no-op if URL parsing fails
    }
  }

  // Run ASAP (before DOM load), then on DOM ready, page show, and after SPA-like navs
  cleanURL();
  document.addEventListener('DOMContentLoaded', cleanURL);
  window.addEventListener('pageshow', cleanURL);

  // In case your theme uses pushState for in-page nav, patch history methods
  const _push = history.pushState;
  const _replace = history.replaceState;
  history.pushState = function () { _push.apply(this, arguments); cleanURL(); };
  history.replaceState = function () { _replace.apply(this, arguments); cleanURL(); };
})();
</script>

<!-- end custom head snippets -->
